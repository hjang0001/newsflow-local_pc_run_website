<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EconomyFlow | Global Macro Insights</title>
    <style>
        :root {
            --bg: #f8f9fa; --card: #ffffff; --text: #1a1a1a;
            --highlight: #2563eb; --border: #e5e7eb;
            --success: #059669; --warning: #d97706; --danger: #dc2626;
        }
        body.dark-mode {
            --bg: #0f172a; --card: #1e293b; --text: #f1f5f9;
            --border: #334155; --highlight: #3b82f6;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); color: var(--text); line-height: 1.5; padding: 20px; transition: 0.3s; }
        
        .container { max-width: 1200px; margin: auto; }
        
        /* Header & Navigation */
        header { text-align: center; margin-bottom: 40px; border-bottom: 2px solid var(--border); padding-bottom: 20px; }
        h1 { font-size: 2.5rem; font-weight: 800; letter-spacing: -1px; }
        .subtitle { color: var(--highlight); font-weight: 600; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px; }
        #timestamp { font-size: 0.8rem; opacity: 0.6; margin-top: 8px; }

        /* Main Dashboard Grid */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px; }
        
        /* Cards */
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        .card-title { font-size: 0.85rem; font-weight: 700; color: var(--highlight); text-transform: uppercase; margin-bottom: 15px; display: flex; justify-content: space-between; }
        
        /* Metric Styling */
        .metric-group { margin-bottom: 15px; }
        .metric-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid var(--border); }
        .metric-row:last-child { border-bottom: none; }
        .metric-label { font-size: 0.95rem; opacity: 0.9; }
        .metric-value { font-family: 'Courier New', monospace; font-weight: 700; font-size: 1.1rem; }

        /* Status Badges */
        .badge { padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 700; }
        .bg-success { background: #d1fae5; color: #065f46; }
        .bg-warning { background: #fef3c7; color: #92400e; }
        .bg-danger { background: #fee2e2; color: #991b1b; }

        /* AI Insight Box */
        .ai-box { background: linear-gradient(135deg, var(--highlight), #4f46e5); color: white; border-radius: 12px; padding: 25px; margin-bottom: 30px; }
        .ai-box h2 { font-size: 1.2rem; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }

        /* Search Bar */
        .search-container { margin-bottom: 25px; }
        #global-search { width: 100%; padding: 15px; border-radius: 10px; border: 1px solid var(--border); background: var(--card); color: var(--text); font-size: 1rem; }

        /* Responsive Adjustments */
        @media (max-width: 768px) { h1 { font-size: 1.8rem; } }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="subtitle">Economy Flow Engine v2.0</div>
        <h1>Global Market Intelligence</h1>
        <div id="timestamp">Syncing with live data...</div>
    </header>

    <div class="search-container">
        <input type="text" id="global-search" placeholder="Quick find (e.g. 'India', 'INR', 'Inflation')...">
    </div>

    <div class="ai-box" id="ai-container">
        <h2>ü§ñ AI Strategic Briefing</h2>
        <p id="ai-summary">Analyzing current macro signals...</p>
        <div style="margin-top: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 0.9rem;">
            <div>
                <strong>Key Risks:</strong>
                <ul id="ai-risks" style="padding-left: 20px; margin-top: 5px;"></ul>
            </div>
            <div>
                <strong>Recommended Moves:</strong>
                <ul id="ai-actions" style="padding-left: 20px; margin-top: 5px;"></ul>
            </div>
        </div>
    </div>

    <div class="dashboard-grid">
        <div class="card">
            <div class="card-title">üá∫üá∏ US Economy <span class="badge bg-success">Live</span></div>
            <div id="us-economy-data">
                <div class="metric-row">
                    <span class="metric-label">Real GDP Growth</span>
                    <span class="metric-value" id="val-gdp">--</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Unemployment</span>
                    <span class="metric-value" id="val-unemployment">--</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Annual Inflation</span>
                    <span class="metric-value" id="val-inflation">--</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Fed Interest Rate</span>
                    <span class="metric-value" id="val-rates">--</span>
                </div>
            </div>
        </div>

        <div class="card" style="border-top: 5px solid var(--danger);">
            <div class="card-title">üìâ Recession Monitor</div>
            <div style="text-align: center; padding: 20px 0;">
                <div style="font-size: 0.8rem; opacity: 0.7;">RISK SCORE</div>
                <div id="risk-score" style="font-size: 3.5rem; font-weight: 900;">--</div>
                <div id="risk-status" class="badge">Checking...</div>
            </div>
            <p id="risk-reason" style="font-size: 0.85rem; font-style: italic; text-align: center; border-top: 1px solid var(--border); padding-top: 10px;"></p>
        </div>

        <div class="card">
            <div class="card-title">üí± Key FX Rates (1 USD)</div>
            <div id="fx-list">
                </div>
        </div>
    </div>
</div>

<script>
    // Theme Toggle Logic
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark-mode');
    }

    // DATA FETCHING ENGINE
    async function loadEconomyData() {
        try {
            const response = await fetch('economyflow.json');
            if (!response.ok) throw new Error("Could not find economyflow.json");
            const data = await response.json();

            updateDashboard(data);
        } catch (err) {
            console.error(err);
            document.getElementById('timestamp').innerHTML = `<span style="color:red">‚ö†Ô∏è Error: ${err.message}. Ensure JSON is in the same folder.</span>`;
        }
    }

    function updateDashboard(data) {
        // Update Timestamp
        document.getElementById('timestamp').innerText = `Last Updated: ${data.last_updated_human || 'Just Now'}`;

        // US Stats
        const us = data.us_economy || {};
        document.getElementById('val-gdp').innerText = us.gdp_growth ? us.gdp_growth + '%' : '--';
        document.getElementById('val-unemployment').innerText = us.unemployment ? us.unemployment + '%' : '--';
        document.getElementById('val-inflation').innerText = us.inflation ? us.inflation + '%' : '--';
        document.getElementById('val-rates').innerText = us.interest_rate ? us.interest_rate + '%' : '--';

        // Recession Risk
        const risk = data.recession_analysis || {};
        const score = risk.risk_score || 0;
        const scoreEl = document.getElementById('risk-score');
        scoreEl.innerText = score + '/100';
        
        const statusEl = document.getElementById('risk-status');
        statusEl.innerText = risk.status || 'Unknown';
        if(score < 30) statusEl.className = 'badge bg-success';
        else if(score < 60) statusEl.className = 'badge bg-warning';
        else statusEl.className = 'badge bg-danger';

        document.getElementById('risk-reason').innerText = risk.reason || 'Stability confirmed.';

        // AI Briefing
        if(data.ai) {
            document.getElementById('ai-summary').innerText = data.ai.connected_summary || "Markets are currently processing live data feeds.";
            document.getElementById('ai-risks').innerHTML = (data.ai.what_matters_today || []).map(r => `<li>${r}</li>`).join('');
            document.getElementById('ai-actions').innerHTML = (data.ai.what_to_do_next || []).map(a => `<li>${a}</li>`).join('');
        }

        // FX Rates (Show Top 5)
        const fx = data.fx_rates || {};
        const commonCodes = ['EUR', 'GBP', 'INR', 'JPY', 'CAD'];
        let fxHtml = '';
        commonCodes.forEach(code => {
            if(fx[code]) {
                fxHtml += `<div class="metric-row"><span>${code}</span><span class="metric-value">${fx[code]}</span></div>`;
            }
        });
        document.getElementById('fx-list').innerHTML = fxHtml;
    }

    // Run on load
    loadEconomyData();
</script>

</body>
</html>